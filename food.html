<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Food Detail</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body {
  margin:0;
  font-family:Arial;
  background:#f9f9f9;
}
img {
  width:100%;
  height:260px;
  object-fit:cover;
}
.container {
  padding:15px;
}
.qty {
  display:flex;
  gap:20px;
  align-items:center;
  margin:20px 0;
}
button {
  padding:10px 16px;
}
.add {
  width:100%;
  background:#111;
  color:white;
  border:none;
  border-radius:8px;
  font-size:16px;
}
</style>
</head>

<body>

<img id="img">

<div class="container">
  <h2 id="name"></h2>
  <p id="code"></p>
  <p id="desc"></p>
  <div id="options"></div>
  <h3 id="price"></h3>

  <div class="qty">
    <button onclick="chg(-1)">âˆ’</button>
    <span id="qty">1</span>
    <button onclick="chg(1)">+</button>
  </div>

  <button class="add" onclick="addCart()">Add to Cart</button>
</div>

<script>
const p = new URLSearchParams(location.search);
const food = {
  name: p.get("name"),
  code: p.get("code"),
  price: Number(p.get("price")),
  desc: p.get("desc"),
  img: p.get("img")
};

const FOOD_DATA = {
  A01: {
    name: "Chicken Burger",
    basePrice: 15,
    options: {
      choices: [
        {
          label: "Spicy Level",
          name: "spicy",
          values: ["Not Spicy", "Spicy"]
        },
        {
          label: "Egg",
          name: "egg",
          values: ["No Egg", "Egg"]
        },
        {
          label: "Lettuce",
          name: "lettuce",
          values: ["No Lettuce", "Lettuce"]
        }
      ],
      addons: [
        { name: "Extra Cheese", price: 2 },
        { name: "Extra Egg", price: 1 },
        { name: "Extra Black Pepper Sauce", price: 0.5 }
      ]
    }
  }
};

const params = new URLSearchParams(location.search);
const code = params.get("code");

const food = FOOD_DATA[code];

document.getElementById("img").src = food.img;
document.getElementById("name").innerText = food.name;
document.getElementById("code").innerText = food.code;
document.getElementById("desc").innerText = food.desc;
document.getElementById("price").innerText = "RM " + food.price;

let qty = 1;
function chg(n){
  qty += n;
  if(qty < 1) qty = 1;
  document.getElementById("qty").innerText = qty;
}

function addCart(){
  const cart = JSON.parse(localStorage.getItem("cart") || "[]");

  cart.push({
    ...food,
    qty: qty
  });

  localStorage.setItem("cart", JSON.stringify(cart));
  alert("Added to cart ðŸ›’");
  history.back();
}

const optionsDiv = document.getElementById("options");
let totalPrice = food.basePrice;

// Render choice options
food.options.choices.forEach(group => {
  const div = document.createElement("div");
  div.innerHTML = `<p><strong>${group.label}</strong></p>`;

  group.values.forEach((v, i) => {
    div.innerHTML += `
      <label>
        <input type="radio"
               name="${group.name}"
               value="${v}"
               ${i === 0 ? "checked" : ""}
               onchange="updatePrice()">
        ${v}
      </label><br>
    `;
  });

  optionsDiv.appendChild(div);
});

// Render add-ons
const addonDiv = document.createElement("div");
addonDiv.innerHTML = "<p><strong>Add-ons</strong></p>";

food.options.addons.forEach(a => {
  addonDiv.innerHTML += `
    <label>
      <input type="checkbox"
             data-price="${a.price}"
             onchange="updatePrice()">
      ${a.name} (+RM ${a.price})
    </label><br>
  `;
});

optionsDiv.appendChild(addonDiv);

function updatePrice() {
  let price = food.basePrice;

  document
    .querySelectorAll("input[type=checkbox]:checked")
    .forEach(cb => {
      price += Number(cb.dataset.price);
    });

  document.getElementById("price").innerText =
    "Total: RM " + price.toFixed(2);
}

updatePrice();
</script>

</body>
</html>