<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Kitchen Screen</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body {
  font-family: Arial, sans-serif;
  background: #f4f4f4;
  margin: 0;
  padding: 15px;
}

h1 {
  text-align: center;
}

.order {
  background: white;
  padding: 15px;
  margin-bottom: 15px;
  border-radius: 10px;
  box-shadow: 0 2px 5px rgba(0,0,0,0.1);
}

.order h2 {
  margin: 0 0 8px;
}

.order ul {
  padding-left: 18px;
}

.order li {
  margin-bottom: 8px;
}

.status {
  font-weight: bold;
  color: green;
}
</style>
</head>

<body>

<h1>üë®‚Äçüç≥ Kitchen Orders</h1>
<div id="orders"></div>

<!-- Firebase COMPAT -->
<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>

<script>
const firebaseConfig = {
  apiKey: "AIzaSyD9x_Fvec4nkEHWVJ6D02xDvW",
  authDomain: "qr-menu-fe159.firebaseapp.com",
  projectId: "qr-menu-fe159",
  storageBucket: "qr-menu-fe159.appspot.com",
  messagingSenderId: "105707127728",
  appId: "1:105707127728:web:65dee4362f74b67f35cc75"
};

firebase.initializeApp(firebaseConfig);
const db = firebase.firestore();

const ordersDiv = document.getElementById("orders");

db.collection("orders")
  .orderBy("time", "asc")
  .onSnapshot(snapshot => {
    ordersDiv.innerHTML = "";

    snapshot.forEach(doc => {
      const o = doc.data();

      const orderDiv = document.createElement("div");
      orderDiv.className = "order";

      let header =
        o.type === "takeaway"
          ? "ü•° Take Away"
          : "üçΩÔ∏è Table " + o.table;

      let itemsHTML = "";

      o.items.forEach(item => {
        let choices = "";
        if (item.choices) {
          for (let k in item.choices) {
            choices += `${item.choices[k]}, `;
          }
        }

        itemsHTML += `
          <li>
            <strong>${item.name}</strong> x${item.qty}<br>
            <small>
              Options: ${choices || "None"}<br>
              Add-ons: ${(item.addons && item.addons.length) ? item.addons.join(", ") : "None"}
            </small>
          </li>
        `;
      });

      orderDiv.innerHTML = `
        <h2>${header}</h2>
        <p>Status: <span class="status">${o.status}</span></p>
        <ul>${itemsHTML}</ul>
      `;

      ordersDiv.appendChild(orderDiv);
    });
  });
</script>

</body>
</html>